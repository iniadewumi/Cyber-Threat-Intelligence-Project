import hashlib
import pathlib
import pandas as pd
import subprocess

ROOT = pathlib.Path().resolve()
DATA = ROOT / 'Data'
CSV = DATA / 'CSVs'
MALWARE = CSV / 'Malware Datasets'
HOME = pathlib.Path.home()
SCAN_FOLDER = DATA / "Scan Folder"

# WLm?ogY_k{!CF.?
for file in HOME.glob("*.exe"):
    file_name = file

# curl -H "Authorization: Basic ******" "https://labs.inquest.net/api/dfi/download?sha256=4ceb4525be677d44012fc1b312b4549221ed57078e368f9578e20a7080088bd2&encrypt_download=1" --output "4ceb4525be677d44012fc1b312b4549221ed57078e368f9578e20a7080088bd2"
class Scanner:
    def __init__(self):
        self.all_malware = pd.read_csv(CSV / "all_dfi.csv")

    def terminal_get_hash(self, file_name):
        x = subprocess.run(['certutil', '-hashfile']+[f"{file_name}"]+['SHA256'], stdout=subprocess.PIPE, text=True)
        return x.stdout.split("\n")[1]
        
        
    def python_get_hash(self, file_name):
        sha256_hash = hashlib.sha256()

        with open(file_name, 'rb') as f:
            for byte_block in iter(lambda: f.read(8192), b""):
                sha256_hash.update(byte_block)
            return sha256_hash.hexdigest()
    

        


# import requests
# sha = "c77502f5c49c34b6733ae1a701a7764da7b724a0efe9546b135b826cbf8de90e"
# url = "https://labs.inquest.net/api/dfi/download?sha256=c77502f5c49c34b6733ae1a701a7764da7b724a0efe9546b135b826cbf8de90e&encrypt_download=1"
# response = requests.request("GET", url, headers={'Authorization': 'Basic ******'})
# if response.status_code == 200:
#   with open(sha, "wb+") as fh:
#     fh.write(response.content)



